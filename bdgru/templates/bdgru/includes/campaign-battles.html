{% load i18n staticfiles customer_tags %}
{# Campaign Battles table #}
{# Vars:  campaign (Campaign Model object. Current Campaign) #}
{#        battle: (Battle Model object. Current battle) #}
{#        activitytypes ( #}
{#        small (bool, optional. default False. Small size control and text.) #}

        <!-- Battles -->
        {% if campaign %}{% with camp=campaign battles=campaign.battles %}
            <table id="datatable-battles" class="table table-striped table-bordered dt-responsive nowrap  {% if small %}small{% endif %}" cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Provider</th>
                    {% for t, meta in activitytypes.Metas.items %}
                    <th>{{ meta.1 }}</th>
                    {% endfor %}
{#                    <th class="text-center">Activities</th>#}
                    <th>Started</th>
                    <th>Finished</th>
                </tr>
                </thead>
                <tbody>
                {% for btl in battles.all %}
                <tr id="id_row_{{ btl.id }}" {% if btl.id == battle.id %}class="warning"{% endif %}>
                    <th scope="row">{{ btl.id }}</th>
                    <td>
                        <a href="{% url 'dash_campaign' id=camp.id action='battle' battle_id=btl.id %}"><i class="{% call_with_func_and_args providers 'get_icon' btl.provider %}"></i> {{ btl.provider }}</a>
                        &nbsp;<a href="{{ btl.link }}" target="_blank"><i class="fa fa-external-link"></i></a>
                    </td>
                    {% for activity in btl.latest_activities %}
                    <td>
                        <i class="{% call_with_func_and_args activitytypes 'get_icon' activity.type %}"></i>
                        {{ activity.count }}
                    </td>
                    {% endfor %}
{#                    <td><ul class="list-inline">#}
{#                    {% for activity in btl.latest_activities %}#}
{#                        <li><i class="{% call_with_func_and_args activitytypes 'get_icon' activity.type %}"></i> {% call_with_func_and_args activitytypes 'get_text' activity.type %}#}
{#                        {{ activity.count }}</li>#}
{#                    {% endfor %}</ul>#}
{#                    </td>#}
                    <td>{{ btl.started }}</td>
                    <td>{{ btl.finished }}</td>
                </tr>

                {% endfor %}

                </tbody>
            </table>
        {% endwith %}{% endif %}

        <!-- battles END -->

